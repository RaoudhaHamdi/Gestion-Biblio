{"ast":null,"code":"import _regeneratorRuntime from \"/home/raoudha/Desktop/Gestion-Biblio/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/raoudha/Desktop/Gestion-Biblio/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/raoudha/Desktop/Gestion-Biblio/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/raoudha/Desktop/Gestion-Biblio/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/raoudha/Desktop/Gestion-Biblio/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/raoudha/Desktop/Gestion-Biblio/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/raoudha/Desktop/Gestion-Biblio/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/raoudha/Desktop/Gestion-Biblio/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/raoudha/Desktop/Gestion-Biblio/src/PureComp/pagination.jsx\";\nimport React, { Component } from 'react';\nimport BooksList from './BooksList';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nvar size = 5;\nvar arr = [];\n\nvar Pagination =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Pagination, _Component);\n\n  function Pagination(props) {\n    var _this;\n\n    _classCallCheck(this, Pagination);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Pagination).call(this, props));\n\n    _this.handleChange = function (idx) {\n      var selectedBook = _this.state.books[idx];\n\n      _this.setState({\n        idx: idx,\n        title: selectedBook.title,\n        author: selectedBook.a3uthor,\n        price: selectedBook.price,\n        isbn: selectedBook.isbn,\n        description: selectedBook.description\n      });\n    };\n\n    _this.state = {\n      books: _this.props.books,\n      skip: _this.props.skip,\n      currPage: _this.props.currPage,\n      totalPages: \"\"\n    };\n    _this.handleClick = _this.handleClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  } // skip = (this.state.currPage - 1) * size;\n\n\n  _createClass(Pagination, [{\n    key: \"count\",\n    value: function () {\n      var _count = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var response, totalPages;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return axios.get('http://localhost:3000/api/booksData/count');\n\n              case 2:\n                response = _context.sent;\n\n                if (response.status === 200) {\n                  totalPages = Math.ceil(response.data.count / size);\n                  console.log(\"//\" + totalPages);\n                } else {\n                  console.log(response.status);\n                }\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function count() {\n        return _count.apply(this, arguments);\n      }\n\n      return count;\n    }()\n  }, {\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var response, i;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return axios.get('http://localhost:3000/api/booksData/count');\n\n              case 2:\n                response = _context2.sent;\n\n                if (response.status === 200) {\n                  this.setState({\n                    totalPages: Math.ceil(response.data.count / size)\n                  });\n                  console.log(\".....\" + this.state.totalPages);\n                } else {\n                  console.log(response.status);\n                }\n\n                for (i = 1; i <= this.state.totalPages; i++) {\n                  arr.push(i);\n                }\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"getPage\",\n    value: function getPage(i) {\n      var _this2 = this;\n\n      console.log(i);\n      var skip = (i - 1) * size;\n      axios.get(\"http://localhost:3000/api/booksData\", {\n        params: {\n          filter: {\n            \"include\": \"BookAuth\",\n            \"limit\": size,\n            \"offset\": skip\n          }\n        }\n      }).then(function (res) {\n        _this2.setState({\n          books: res.data\n        });\n\n        console.log(_this2.state.books);\n      }).catch(function (err) {\n        return alert(err);\n      });\n    }\n  }, {\n    key: \"handleClick\",\n    value: function () {\n      var _handleClick = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(id, idx) {\n        var booksCopy, response;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                console.log(this.state.idx);\n                booksCopy = Array.from(this.state.books);\n                _context3.next = 4;\n                return axios.delete(\"http://localhost:3000/api/booksData/\".concat(id));\n\n              case 4:\n                response = _context3.sent;\n\n                if (response.status === 200) {\n                  booksCopy.splice(idx, 1);\n                  this.setState({\n                    books: booksCopy\n                  });\n                } else {\n                  alert(response.status);\n                }\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function handleClick(_x, _x2) {\n        return _handleClick.apply(this, arguments);\n      }\n\n      return handleClick;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(\"div\", {\n        className: \"display\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, React.createElement(BooksList, {\n        books: this.state.books,\n        handleClick: this.handleClick,\n        handleChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }), React.createElement(\"ul\", {\n        className: \"Pagination\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, arr.map(function (el) {\n        return React.createElement(\"li\", {\n          onClick: function onClick() {\n            _this3.getPage(el);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104\n          },\n          __self: this\n        }, React.createElement(Link, {\n          to: \"/\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104\n          },\n          __self: this\n        }, el));\n      })));\n    }\n  }]);\n\n  return Pagination;\n}(Component);\n\nexport default Pagination;","map":{"version":3,"sources":["/home/raoudha/Desktop/Gestion-Biblio/src/PureComp/pagination.jsx"],"names":["React","Component","BooksList","Link","axios","size","arr","Pagination","props","handleChange","idx","selectedBook","state","books","setState","title","author","a3uthor","price","isbn","description","skip","currPage","totalPages","handleClick","bind","get","response","status","Math","ceil","data","count","console","log","i","push","params","filter","then","res","catch","err","alert","id","booksCopy","Array","from","delete","splice","map","el","getPage"],"mappings":"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","sourcesContent":["import React,{Component} from 'react'\nimport BooksList from './BooksList'\nimport {Link} from 'react-router-dom'\nimport axios from 'axios'\n\nconst size=5\n\nvar arr=[]\nclass Pagination extends Component{\n   \n        constructor(props) {\n          super(props);\n      \n            this.state = {\n            books:this.props.books,\n            skip:this.props.skip,\n            currPage: this.props.currPage,\n            totalPages:\"\"\n          }\n          this.handleClick = this.handleClick.bind(this);\n        }\n        // skip = (this.state.currPage - 1) * size;\n        async count(){\n          \n          const response=await axios.get('http://localhost:3000/api/booksData/count')\n            if(response.status===200)\n            { \n              let totalPages=Math.ceil((response.data.count)/size)\n              console.log(\"//\"+totalPages)\n            }\n            else \n            {\n              console.log (response.status)\n            }\n          }\n    \n           async componentDidMount(){\n            const response=await axios.get('http://localhost:3000/api/booksData/count')\n            if(response.status===200)\n            {\n              this.setState({totalPages:Math.ceil((response.data.count)/size)})\n              console.log(\".....\"+this.state.totalPages)\n            }\n            else \n            {\n              console.log (response.status)\n            }\n             \n            for (let i=1;i<=this.state.totalPages;i++) {\n              arr.push(i)\n           }\n          }\n                              \n           getPage(i){\n             console.log(i)\n            let skip = (i - 1) * size\n                axios.get(\"http://localhost:3000/api/booksData\", {\n           params: {\n          filter:{\n            \"include\": \"BookAuth\",\n             \"limit\":size,\n             \"offset\":skip,\n          }}})\n          .then(res=> { this.setState({books:res.data})\n          console.log(this.state.books)})\n          .catch(err => alert(err)) \n        }\n\n        async handleClick(id,idx) {\n          console.log(this.state.idx)\n          const booksCopy=Array.from(this.state.books)\n          const response=await axios.delete(`http://localhost:3000/api/booksData/${id}`)\n          if (response.status === 200) {\n              booksCopy.splice(idx, 1)\n              this.setState({books: booksCopy})\n      \n        }\n        else {alert (response.status)}\n        }\n\n        handleChange = idx => {\n          const selectedBook = this.state.books[idx];\n      \n          this.setState({\n            idx: idx,\n            title: selectedBook.title,\n            author: selectedBook.a3uthor,\n            price: selectedBook.price,\n            isbn: selectedBook.isbn,\n            description: selectedBook.description\n          });\n        };\n      \n          render(){\n          return (\n            <div className=\"display\">\n            <BooksList\n                 books={this.state.books}\n                handleClick={this.handleClick}\n                handleChange={this.handleChange}\n              />\n              <ul className=\"Pagination\">\n            {\n            arr.map(el=>{ return <li onClick={()=>{this.getPage(el)}}><Link to=\"/\">{el}</Link></li>})\n            }   \n               \n             </ul>\n             </div>\n          )\n            }\n          }\n      \n\n      export default Pagination\n     \n\n"]},"metadata":{},"sourceType":"module"}